var __generator=this&&this.__generator||function(t,e){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,r,a,s;return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol==="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(t){return function(e){return u([t,e])}}function u(s){if(i)throw new TypeError("Generator is already executing.");while(n)try{if(i=1,r&&(a=s[0]&2?r["return"]:s[0]?r["throw"]||((a=r["return"])&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;if(r=0,a)s=[s[0]&2,a.value];switch(s[0]){case 0:case 1:a=s;break;case 4:n.label++;return{value:s[1],done:false};case 5:n.label++;r=s[1];s=[0];continue;case 7:s=n.ops.pop();n.trys.pop();continue;default:if(!(a=n.trys,a=a.length>0&&a[a.length-1])&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!a||s[1]>a[0]&&s[1]<a[3])){n.label=s[1];break}if(s[0]===6&&n.label<a[1]){n.label=a[1];a=s;break}if(a&&n.label<a[2]){n.label=a[2];n.ops.push(s);break}if(a[2])n.ops.pop();n.trys.pop();continue}s=e.call(t,n)}catch(t){s=[6,t];r=0}finally{i=a=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:true}}};System.register(["./p-44cbb351.system.js"],(function(t){"use strict";var e,n,i,r,a;return{setters:[function(t){e=t.r;n=t.c;i=t.h;r=t.g;a=t.H}],execute:function(){var s="taro-movable-view-core{display:inline-block;position:absolute;left:0;top:0;width:10px;height:10px}";var o=undefined&&undefined.__awaiter||function(t,e,n,i){function r(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,a){function s(t){try{u(i.next(t))}catch(t){a(t)}}function o(t){try{u(i["throw"](t))}catch(t){a(t)}}function u(t){t.done?n(t.value):r(t.value).then(s,o)}u((i=i.apply(t,e||[])).next())}))};var u=t("taro_movable_view_core",function(){function t(t){var i=this;e(this,t);this.onChange=n(this,"change",7);this.onScale=n(this,"scale",7);this.onHTouchMove=n(this,"htouchmove",7);this.onVTouchMove=n(this,"vtouchmove",7);this.x=0;this.y=0;this.direction="none";this.outOfBounds=false;this.inertia=false;this.friction=2;this.damping=20;this.disabled=false;this.scale=false;this.scaleMin=.5;this.scaleMax=10;this.scaleValue=1;this.animation=true;this.translateX=0;this.translateY=0;this.origin={x:0,y:0};this.area={width:0,height:0};this.originScale=1;this.currentScale=1;this.width=0;this.height=0;this.minX=0;this.minY=0;this.maxX=0;this.maxY=0;this.baseX=0;this.baseY=0;this.offset={x:0,y:0};this.scaleOffset={x:0,y:0};this.getLimitXY=function(t,e){var n=false;t>i.maxX?(t=i.maxX,n=true):t<i.minX&&(t=i.minX,n=true);e>i.maxY?(e=i.maxY,n=true):e<i.minY&&(e=i.minY,n=true);return{x:t,y:e,outOfBounds:n}};this.animationTo=function(t,e,n,r,a,s,o){if(i.animation){i.setTransform(t,e,n,r,a,s);o===null||o===void 0?void 0:o()}else{i.setTransform(t,e,n,r,a,s)}};this.setTransform=function(t,e,n,r,a,s){t=Number(t.toFixed(1));e=Number(e.toFixed(1));n=Number((n!==null&&n!==void 0?n:i.currentScale).toFixed(3));if(!i.outOfBounds){var o=i.getLimitXY(t,e);t=o.x;e=o.y}var u=function(t,e){return+((1e3*t-1e3*e)/1e3).toFixed(1)};var c=u(t,i.scaleOffset.x);var l=u(e,i.scaleOffset.y);if(i.translateX!==t||i.translateY!==e){!a&&i.onChange.emit({x:c,y:l,source:r})}if(n!==i.currentScale){s&&i.onScale.emit({scale:n,x:c,y:l})}var h="translateX("+t+"px) translateY("+e+"px) translateZ(0px) scale("+n+")";i.element.style.transform=h;i.element.style.webkitTransform=h;i.translateX=t;i.translateY=e;i.currentScale=n};this.updateOffset=function(){var t=function(e,n){if(e===n||!e.offsetParent){return{left:0,top:0}}var i=t(e.offsetParent,n);return{left:e.offsetLeft+i.left,top:e.offsetTop+i.top}};if(!i.parent){return}var e=t(i.element,i.parent);i.offset.x=e.left;i.offset.y=e.top};this.updateScaleOffset=function(t){if(t===void 0){t=i.currentScale}var e=i.element.getBoundingClientRect();i.height=e.height/i.currentScale;i.width=e.width/i.currentScale;i.scaleOffset.x=(i.width*t-i.width)/2;i.scaleOffset.y=(i.height*t-i.height)/2};this.updateBoundary=function(){var t=0-i.offset.x+i.scaleOffset.x;var e=i.area.width-i.width-i.offset.x-i.scaleOffset.x;i.minX=Math.min(t,e);i.maxX=Math.max(t,e);var n=0-i.offset.y+i.scaleOffset.y;var r=i.area.height-i.height-i.offset.y-i.scaleOffset.y;i.minY=Math.min(n,r);i.maxY=Math.max(n,r)};this.updateScale=function(t,e,n){if(!i.scale){return}var r=i.adjustScale(t);i.updateScaleOffset(r);i.updateBoundary();var a=i.getLimitXY(i.translateX,i.translateY),s=a.x,o=a.y;if(e){i.animationTo(s,o,r,"",true,true,n)}else if(!i.updating){i.updating=true;requestAnimationFrame((function(){i.setTransform(s,o,r,"",true,true);i.updating=false}))}};this.setOriginScale=function(t){i.originScale=t};this.adjustScale=function(t){return Math.min(10,i.scaleMax,Math.max(.5,i.scaleMin,t))};this.handleTouchStart=function(t){var e=t.touches;if(i.disabled||e.length>1||!i.element){return}var n=e[0];i.touching=true;i.firstMoveFireEvent=false;i.origin.x=n.screenX;i.origin.y=n.screenY;i.baseX=i.translateX;i.baseY=i.translateY;i.element.style.willChange="transform"};this.handleTouchMove=function(t){var e=t.touches;if(i.disabled||!i.element||i.scaling||!i.touching||e.length>1){return}t.preventDefault();var n=e[0];var r=n.screenX-i.origin.x;var a=n.screenY-i.origin.y;i.setTransform(i.xMove?r+i.baseX:0,i.yMove?a+i.baseY:0);if(!i.firstMoveFireEvent){i.firstMoveFireEvent=true;var s=Math.abs(r)>Math.abs(a)?i.onHTouchMove:i.onVTouchMove;s.emit({originalEvent:t,bubbles:false,capturePhase:false,composed:true,extraFields:{touches:t.touches||{},changedTouches:t.changedTouches||{}}})}};this.handleTouchEnd=function(t){var e=t.changedTouches[0];if(i.disabled||!i.touching||!e){return}i.touching=false;var n=e.screenX-i.origin.x;var r=e.screenY-i.origin.y;i.setTransform(i.xMove?n+i.baseX:0,i.yMove?r+i.baseY:0)}}t.prototype.watchX=function(t){this.setTransform(parseFloat(""+(t||0)),this.translateY)};t.prototype.watchY=function(t){this.setTransform(this.translateX,parseFloat(""+(t||0)))};t.prototype.watchScaleMinOrMax=function(){if(!this.scale)return false;this.updateScale(this.currentScale,true);this.setOriginScale(this.currentScale)};t.prototype.watchScaleValue=function(t){if(!this.scale){return false}this.updateScale(t,true);this.setOriginScale(t);return t};t.prototype.setParent=function(t){var e=t.element,n=t.area;return o(this,void 0,void 0,(function(){var t;return __generator(this,(function(i){t=this.scale?this.scaleValue:1;this.area=n;this.parent=e;this.updateOffset();this.updateScaleOffset(t);this.updateBoundary();this.setTransform(Number(this.x)+this.scaleOffset.x,Number(this.y)+this.scaleOffset.y,t,"",true);this.setOriginScale(t);return[2]}))}))};t.prototype.endScale=function(){return o(this,void 0,void 0,(function(){return __generator(this,(function(t){this.scaling=false;this.setOriginScale(this.currentScale);return[2]}))}))};t.prototype.setScale=function(t){return o(this,void 0,void 0,(function(){return __generator(this,(function(e){if(!this.scale){return[2]}this.scaling=true;this.updateScale(t*this.originScale);return[2]}))}))};t.prototype.connectedCallback=function(){var t=this;this.observer=new MutationObserver((function(e){e.forEach((function(e){var n=e.attributeName;if(n&&["class","style"].includes(n)){var i=e.oldValue;var r=e.target.getAttribute(n);if(i===r){return}var a=function(t){return t===null||t===void 0?void 0:t.split(";").filter((function(t){return!["transform","will-change"].find((function(e){return t.trim().startsWith(e)}))})).join(";")};if(n==="style"&&a(r)===a(i)){return}t.updateOffset();t.updateScaleOffset();t.updateBoundary();t.setTransform(t.translateX,t.translateY)}}))}));this.observer.observe(this.element,{attributes:true,attributeOldValue:true})};t.prototype.disconnectedCallback=function(){var t;(t=this.observer)===null||t===void 0?void 0:t.disconnect()};t.prototype.componentDidLoad=function(){this.element.style.transformOrigin="center";this.xMove=["horizontal","all"].includes(this.direction);this.yMove=["vertical","all"].includes(this.direction);if(this.friction<=0){this.friction=2}if(this.x||this.y){var t=parseFloat(""+(this.x||0));var e=parseFloat(""+(this.y||0));this.setTransform(t,e)}};t.prototype.render=function(){return i(a,{onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,onTouchEnd:this.handleTouchEnd})};Object.defineProperty(t.prototype,"element",{get:function(){return r(this)},enumerable:false,configurable:true});Object.defineProperty(t,"watchers",{get:function(){return{x:["watchX"],y:["watchY"],scaleMin:["watchScaleMinOrMax"],scaleMax:["watchScaleMinOrMax"],scaleValue:["watchScaleValue"]}},enumerable:false,configurable:true});return t}());u.style=s}}}));